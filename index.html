<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Плеер для аниме - Моя девушка не просто милашка</title>
    <style>
        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --player-bg: #ffffff;
            --border-color: #dee2e6;
            --button-bg: #6c757d;
            --button-hover: #5a6268;
            --primary: #d63384;
            --vk-color: #4a76a8;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --player-bg: #1e1e1e;
            --border-color: #444;
            --button-bg: #495057;
            --button-hover: #343a40;
            --primary: #ff6ec7;
            --vk-color: #5b88bd;
        }

        * {
            transition: background 0.3s, color 0.3s, border-color 0.3s;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .anime-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .anime-title {
            color: var(--primary);
            margin: 0;
            font-size: 2.2rem;
        }

        .shikimori-link {
            display: inline-block;
            background: #2c3e50;
            color: white;
            padding: 8px 15px;
            border-radius: 4px;
            text-decoration: none;
            margin-top: 10px;
            font-weight: bold;
            transition: background 0.3s;
        }

        .shikimori-link:hover {
            background: #1a252f;
        }

        .player-container {
            background: var(--player-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .player-wrapper {
            position: relative;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            background: #000;
        }

        #vkPlayer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .controls {
            padding: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            align-items: center;
        }

        .episode-btn {
            background: var(--button-bg);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s;
        }

        .episode-btn:hover {
            background: var(--button-hover);
        }

        .episode-btn.active {
            background: var(--primary);
            font-weight: bold;
        }

        .theme-toggle {
            background: var(--vk-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-left: auto;
            transition: opacity 0.3s;
        }

        .theme-toggle:hover {
            opacity: 0.9;
        }

        .episode-title {
            text-align: center;
            padding: 15px;
            font-weight: bold;
            background: rgba(0,0,0,0.05);
            border-bottom: 1px solid var(--border-color);
            font-size: 1.2rem;
        }

        .vk-info {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
            }
            
            .theme-toggle {
                margin-left: 0;
                margin-top: 10px;
                width: 100%;
            }
            
            .anime-title {
                font-size: 1.8rem;
            }
            
            .episode-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="anime-header">
            <h1 class="anime-title">Моя девушка не просто милашка</h1>
            <a href="https://shikimori.one/animes/50594-sasaki-to-miyano" 
               class="shikimori-link" 
               target="_blank">
                Смотреть на Shikimori
            </a>
        </div>

        <div class="player-container">
            <div class="episode-title" id="episodeTitle">Загрузка плеера...</div>
            <div class="player-wrapper">
                <div id="vkPlayer"></div>
            </div>
            <div class="controls">
                <button class="episode-btn active" data-episode="1">Серия 1</button>
                <button class="episode-btn" data-episode="2">Серия 2</button>
                <button class="episode-btn" data-episode="3">Серия 3</button>
                <button class="episode-btn" data-episode="4">Серия 4</button>
                <button class="theme-toggle" id="themeToggle">Темная тема</button>
            </div>
        </div>
        
        <div class="vk-info">
            Видео предоставлено ВКонтакте
        </div>
    </div>

    <script>
        // Конфигурация плеера
        const episodes = {
            1: {
                id: '-231399388_456239017', // Пример ID видео ВК
                title: 'Серия 1 - Начало истории'
            },
            2: {
                id: '-200318327_456239019',
                title: 'Серия 2 - Развитие событий'
            },
            3: {
                id: '-200318327_456239020',
                title: 'Серия 3 - Кульминация'
            },
            4: {
                id: '-200318327_456239021',
                title: 'Серия 4 - Финал сезона'
            }
        };

        // Инициализация плеера
        let vkPlayer;
        const episodeTitle = document.getElementById('episodeTitle');
        const themeToggle = document.getElementById('themeToggle');
        const episodeButtons = document.querySelectorAll('.episode-btn');

        // Загрузка VK API и инициализация плеера
        function initVKPlayer(episodeId) {
            if (window.VK && VK.Widgets) {
                createPlayer(episodeId);
            } else {
                // Динамическая загрузка VK API
                const script = document.createElement('script');
                script.src = 'https://vk.com/js/api/openapi.js?169';
                script.onload = () => {
                    VK.init({apiId: 1234567, onlyWidgets: true});
                    createPlayer(episodeId);
                };
                document.head.appendChild(script);
            }
        }

        // Создание VK плеера
        function createPlayer(episodeId) {
            if (vkPlayer) {
                document.getElementById('vkPlayer').innerHTML = '';
            }
            
            vkPlayer = new VK.Widgets.Player('vkPlayer', {
                width: '100%',
                height: '100%',
                video: episodeId,
                autoplay: 1
            });
        }

        // Переключение серий
        function loadEpisode(episodeNum) {
            const episode = episodes[episodeNum];
            if (!episode) return;
            
            episodeTitle.textContent = episode.title;
            initVKPlayer(episode.id);
            
            // Обновление активной кнопки
            episodeButtons.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.episode == episodeNum);
            });
        }

        // Переключение темы
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            
            // Сохранение темы в localStorage
            localStorage.setItem('theme', newTheme);
            
            // Обновление текста кнопки
            themeToggle.textContent = newTheme === 'dark' ? 'Светлая тема' : 'Темная тема';
        }

        // Загрузка сохраненной темы
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            themeToggle.textContent = savedTheme === 'dark' ? 'Светлая тема' : 'Темная тема';
        }

        // Инициализация плеера
        window.onload = function() {
            loadTheme();
            
            // Загрузка первой серии
            loadEpisode(1);
            
            // Обработчики кнопок
            episodeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    loadEpisode(btn.dataset.episode);
                });
            });
            
            // Обработчик переключения темы
            themeToggle.addEventListener('click', toggleTheme);
        };
    </script>
</body>
</html>
